<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sharief's Productivity Pack v2.5</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 10px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 20px; text-align: center; }
        .header h1 { font-size: 1.5em; margin-bottom: 8px; }
        .top-menu { background: #f8f9fa; padding: 15px; border-bottom: 2px solid #e0e0e0; display: flex; gap: 8px; flex-wrap: wrap; }
        .btn { background: #00b894; color: white; border: none; padding: 10px 15px; border-radius: 8px; font-size: 0.85em; cursor: pointer; }
        .btn-danger { background: #d63031; }
        .tabs { display: flex; overflow-x: auto; background: #f8f9fa; border-bottom: 2px solid #e0e0e0; }
        .tab { padding: 15px 18px; cursor: pointer; white-space: nowrap; border-bottom: 3px solid transparent; font-weight: 500; }
        .tab.active { background: white; border-bottom: 3px solid #667eea; color: #667eea; }
        .content { padding: 20px; }
        .page { display: none; }
        .page.active { display: block; }
        .btn-group { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn-large { padding: 12px 25px; font-size: 0.95em; flex: 1; min-width: 150px; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-top: 15px; }
        .day-header { text-align: center; font-weight: bold; padding: 10px 4px; background: #000; color: white; border-radius: 6px; font-size: 0.75em; }
        .day-cell { aspect-ratio: 1; border: 1.5px solid #000; border-radius: 6px; padding: 3px; min-height: 45px; }
        .day-cell input { width: 100%; height: 100%; border: none; font-size: 0.7em; text-align: center; }
        textarea { width: 100%; border: 1px solid #000; border-radius: 6px; padding: 12px; font-family: inherit; font-size: 1em; min-height: 80px; }
        input[type="text"], input[type="number"], input[type="date"] { width: 100%; padding: 12px; border: 1px solid #000; border-radius: 6px; font-size: 1em; margin-bottom: 12px; }
        .week-grid { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 15px; }
        .day-box { border: 1.5px solid #000; border-radius: 8px; padding: 15px; }
        .day-box h3 { margin-bottom: 10px; font-size: 1.1em; border-bottom: 2px solid #000; padding-bottom: 6px; }
        .priority-box { background: #f8f9fa; padding: 20px; border: 2px solid #000; border-radius: 10px; margin-bottom: 20px; }
        .priority-box h3 { margin-bottom: 15px; }
        .practice-menu { background: #f8f9fa; border: 2px solid #000; border-radius: 10px; padding: 20px; margin: 20px 0; }
        .practice-menu h3 { text-align: center; margin-bottom: 20px; }
        .practice-item { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; padding: 10px; background: white; border-radius: 8px; }
        .practice-item input[type="checkbox"] { width: 25px; height: 25px; }
        .practice-item input[type="text"] { flex: 1; margin-bottom: 0; }
        .water-tracker { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 15px; }
        .water-glass { aspect-ratio: 3/4; border: 2px solid #000; border-radius: 8px; cursor: pointer; min-height: 60px; }
        .water-glass.filled { background: #000; }
        .habit-tracker { margin-top: 20px; overflow-x: auto; }
        .habit-row { display: grid; grid-template-columns: 1fr repeat(7, 40px); gap: 6px; margin-bottom: 10px; align-items: center; }
        .habit-name { padding: 10px; background: #f8f9fa; border: 1px solid #000; border-radius: 6px; font-size: 0.9em; }
        .habit-checkbox { width: 35px; height: 35px; cursor: pointer; }
        .habit-progress { grid-column: span 7; text-align: right; font-size: 0.85em; font-weight: bold; color: #00b894; padding: 5px; }
        .week-btn { padding: 10px 15px; border: 2px solid #000; border-radius: 8px; background: white; cursor: pointer; white-space: nowrap; }
        .week-btn.active { background: #000; color: white; }
        .budget-table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .budget-table th, .budget-table td { padding: 12px 8px; border: 1px solid #000; }
        .budget-table th { background: #f1f3f5; font-weight: 600; }
        .budget-table input { padding: 14px 10px; font-size: 1.05em; margin-bottom: 0; }
        .auto-calc { font-weight: bold; color: #00b894; font-size: 1.1em; }
        .savings-progress { font-weight: bold; color: #667eea; }
        .save-indicator { position: fixed; top: 70px; right: 15px; background: #00b894; color: white; padding: 12px 20px; border-radius: 10px; opacity: 0; transition: opacity 0.3s; z-index: 1000; }
        .save-indicator.show { opacity: 1; }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); }
        .modal-content { background: white; margin: 15% auto; padding: 30px; border-radius: 15px; width: 90%; max-width: 400px; text-align: center; }
        .modal h3 { color: #d63031; margin-bottom: 15px; }
        .modal p { margin-bottom: 25px; }
        .modal-btn { padding: 12px 25px; border: none; border-radius: 8px; font-size: 1em; cursor: pointer; margin: 5px; }
        .modal-btn-cancel { background: #95a5a6; color: white; }
        .modal-btn-danger { background: #d63031; color: white; }
        @media (min-width: 768px) {
            .header h1 { font-size: 2em; }
            .content { padding: 30px; }
            .week-grid { grid-template-columns: repeat(7, 1fr); }
            .water-tracker { grid-template-columns: repeat(8, 1fr); }
            .habit-row { grid-template-columns: 150px repeat(7, 30px); }
            .calendar-grid { gap: 8px; }
            .day-cell { min-height: 60px; padding: 5px; }
        }
    </style>
</head>
<body>
    <div class="save-indicator" id="saveIndicator">âœ“ Saved!</div>
    <div id="resetModal" class="modal">
        <div class="modal-content">
            <h3>âš ï¸ Are You Sure?</h3>
            <p id="resetMessage"></p>
            <button class="modal-btn modal-btn-cancel" onclick="closeModal()">Cancel</button>
            <button class="modal-btn modal-btn-danger" onclick="confirmReset()">Yes, Reset</button>
        </div>
    </div>
    <div class="container">
        <div class="header">
            <h1>ğŸ“‹ Sharief's Productivity Pack</h1>
            <p>Mobile-Optimized â€¢ Auto-Saving</p>
        </div>
        <div class="top-menu">
            <button class="btn" onclick="exportData()">ğŸ’¾ Export</button>
            <button class="btn" onclick="document.getElementById('importFile').click()">ğŸ“¥ Import</button>
            <input type="file" id="importFile" accept=".json" style="display:none" onchange="importData(event)">
            <button class="btn btn-danger" onclick="showResetModal('all')">ğŸ—‘ï¸ Reset All</button>
        </div>
        <div class="tabs" id="tabs"></div>
        <div class="content" id="content"></div>
    </div>
    <script>
        const habits = ['Fajr on time', 'Exercise 30 min', 'Read Qur\'an', 'Drink 8 glasses', 'No phone after 9pm', 'Journal', 'Learn something', 'Help someone', 'Sleep before 11pm', 'Healthy eating'];
        let saveTimeout, currentWeek = 0, resetTarget = '';
        
        function saveData(key, value) {
            const data = JSON.parse(localStorage.getItem('pd') || '{}');
            data[key] = value;
            localStorage.setItem('pd', JSON.stringify(data));
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => {
                document.getElementById('saveIndicator').classList.add('show');
                setTimeout(() => document.getElementById('saveIndicator').classList.remove('show'), 2000);
            }, 500);
        }
        
        function loadData(key) {
            const data = JSON.parse(localStorage.getItem('pd') || '{}');
            return data[key] || '';
        }
        
        function exportData() {
            const data = localStorage.getItem('pd') || '{}';
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `backup-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            alert('âœ… Backup exported!');
        }
        
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    localStorage.setItem('pd', e.target.result);
                    alert('âœ… Data imported!');
                    location.reload();
                } catch { alert('âŒ Error importing'); }
            };
            reader.readAsText(file);
        }
        
        function showResetModal(target) {
            resetTarget = target;
            document.getElementById('resetMessage').textContent = target === 'all' ? 'Delete ALL data?' : `Clear ${target} page?`;
            document.getElementById('resetModal').style.display = 'block';
        }
        
        function closeModal() {
            document.getElementById('resetModal').style.display = 'none';
        }
        
        function confirmReset() {
            // NOTE: This is a simple global reset. For a targeted reset, 
            // you'd need to identify and remove only the keys related to 'resetTarget'.
            // For now, we stick to the original behavior of reloading after a message.
            if (resetTarget === 'all') {
                localStorage.removeItem('pd');
                alert('âœ… All data reset!');
            } else {
                alert(`âœ… ${resetTarget} reset!`);
            }
            closeModal();
            location.reload();
        }
        
        function showPage(name) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(name).classList.add('active');
            // The next line uses event.target, which is only available if showPage is called from an event listener.
            // When called programmatically (like on init), this may fail. A small check is safer.
            const clickedTab = event.target.closest('.tab');
            if(clickedTab) clickedTab.classList.add('active');
        }
        
        function initApp() {
            const tabs = document.getElementById('tabs');
            const content = document.getElementById('content');
            
            const pages = ['daily', 'weekly', 'monthly', 'habits', 'study', 'budget', 'quran', 'life', 'growth'];
            const icons = ['â°', 'ğŸ“†', 'ğŸ—“ï¸', 'ğŸ’ª', 'ğŸ§ ', 'ğŸ’°', 'ğŸ“–', 'ğŸ¡', 'ğŸŒ±'];
            
            pages.forEach((p, i) => {
                const tab = document.createElement('div');
                tab.className = 'tab' + (i === 0 ? ' active' : '');
                tab.textContent = icons[i] + ' ' + p.charAt(0).toUpperCase() + p.slice(1);
                tab.onclick = (e) => showPage(p, e); // Pass event here
                tabs.appendChild(tab);
            });
            
            // Daily Page
            content.innerHTML += `
<div id="daily" class="page active">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('daily')">ğŸ”„ Reset</button>
    </div>
    <h2>â° Daily Planner</h2>
    <input type="date" class="auto-save" data-key="daily-date">
    <div class="priority-box">
        <h3>ğŸ¯ Most Important Task</h3>
        <input type="text" class="auto-save" data-key="daily-mit" placeholder="What matters most?">
    </div>
    <div class="practice-menu">
        <h3>âœ¨ DAILY PRACTICE MENU</h3>
        <h4>ğŸƒ Body</h4>
        <div class="practice-item">
            <input type="checkbox" class="auto-save-check" data-key="p-stretch">
            <span>Stretch/Exercise</span>
        </div>
        <h4 style="margin-top:15px">ğŸ§  Mind</h4>
        <div class="practice-item">
            <input type="checkbox" class="auto-save-check" data-key="p-read">
            <span>Reading</span>
        </div>
        <h4 style="margin-top:15px">ğŸ˜Š Joy</h4>
        <div class="practice-item">
            <input type="checkbox" class="auto-save-check" data-key="p-game">
            <span>Gaming (COD)</span>
        </div>
        <h4 style="margin-top:15px">ğŸ’– Soul</h4>
        <div class="practice-item">
            <input type="checkbox" class="auto-save-check" data-key="p-quran">
            <span>Qur'an/Dhikr</span>
        </div>
    </div>
    <h3>ğŸ“‹ To-Do</h3>
    <textarea rows="6" class="auto-save" data-key="daily-todo" placeholder="Tasks..."></textarea>
    <h3 style="margin-top:20px">ğŸ’§ Water (8 glasses)</h3>
    <div class="water-tracker" id="waterTracker"></div>
    <h3 style="margin-top:20px">ğŸ™ Gratitude</h3>
    <textarea rows="3" class="auto-save" data-key="daily-gratitude"></textarea>
</div>`;
            
            // Weekly Page with Maintenance Tasks moved to the top
            content.innerHTML += `
<div id="weekly" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('weekly')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ“† Weekly Planner</h2>
    <input type="text" class="auto-save" data-key="week-date" placeholder="Week of...">

    <div style="background:#f8f9fa;border:2px solid #000;border-radius:10px;padding:20px;margin-bottom:20px">
        <h3 style="margin-bottom:15px">ğŸ§¼ Weekly Maintenance Tasks</h3>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-beard" style="width:25px;height:25px">
            <span style="flex:1">Shave beard</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-underarms" style="width:25px;height:25px">
            <span style="flex:1">Shave underarms</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-private" style="width:25px;height:25px">
            <span style="flex:1">Shave private parts</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-car" style="width:25px;height:25px">
            <span style="flex:1">Clean car</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-room" style="width:25px;height:25px">
            <span style="flex:1">Clean room</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-cupboard" style="width:25px;height:25px">
            <span style="flex:1">Keep cupboard clean</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="auto-save-check" data-key="w-junk" style="width:25px;height:25px">
            <span style="flex:1">Get rid of junk</span>
        </div>
    </div>
    
    <div class="priority-box">
        <h3>â­ Top 3 Priorities</h3>
        <input type="text" class="auto-save" data-key="week-p1" placeholder="1.">
        <input type="text" class="auto-save" data-key="week-p2" placeholder="2.">
        <input type="text" class="auto-save" data-key="week-p3" placeholder="3.">
    </div>
    <div class="week-grid">
        <div class="day-box"><h3>Monday</h3><textarea rows="4" class="auto-save" data-key="week-mon"></textarea></div>
        <div class="day-box"><h3>Tuesday</h3><textarea rows="4" class="auto-save" data-key="week-tue"></textarea></div>
        <div class="day-box"><h3>Wednesday</h3><textarea rows="4" class="auto-save" data-key="week-wed"></textarea></div>
        <div class="day-box"><h3>Thursday</h3><textarea rows="4" class="auto-save" data-key="week-thu"></textarea></div>
        <div class="day-box"><h3>Friday</h3><textarea rows="4" class="auto-save" data-key="week-fri"></textarea></div>
        <div class="day-box"><h3>Saturday</h3><textarea rows="4" class="auto-save" data-key="week-sat"></textarea></div>
        <div class="day-box"><h3>Sunday</h3><textarea rows="4" class="auto-save" data-key="week-sun"></textarea></div>
    </div>
    
    <h3 style="margin-top:20px">Reflections</h3>
    <textarea rows="3" class="auto-save" data-key="week-ref"></textarea>
</div>`;
            
            // Monthly Page
            content.innerHTML += `
<div id="monthly" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('monthly')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ—“ï¸ Monthly Calendar</h2>
    <input type="text" class="auto-save" data-key="month-name" placeholder="Month...">
    <div class="calendar-grid">
        <div class="day-header">Mon</div>
        <div class="day-header">Tue</div>
        <div class="day-header">Wed</div>
        <div class="day-header">Thu</div>
        <div class="day-header">Fri</div>
        <div class="day-header">Sat</div>
        <div class="day-header">Sun</div>
    </div>
    <div class="calendar-grid" id="calDays"></div>
    <h3 style="margin-top:20px">Notes</h3>
    <textarea rows="4" class="auto-save" data-key="month-notes"></textarea>
</div>`;
            
            // Daily Routine Page (replaces Habits)
            content.innerHTML += `
<div id="habits" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('habits')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ’ª Daily Routine</h2>
    <p style="color:#666;margin-bottom:15px">Today: <strong id="routineDate"></strong> â€¢ Resets daily at midnight</p>
    
    <div style="background:#f8f9fa;border:2px solid #000;border-radius:10px;padding:20px;margin-bottom:20px">
        <h3 style="margin-bottom:15px">ğŸŒ… Morning Routine</h3>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-shower" style="width:25px;height:25px">
            <span style="flex:1">Shower</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-brush" style="width:25px;height:25px">
            <span style="flex:1">Brush teeth</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-bed" style="width:25px;height:25px">
            <span style="flex:1">Make bed</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-stretch5" style="width:25px;height:25px">
            <span style="flex:1">Stretch 5 min</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-dress" style="width:25px;height:25px">
            <span style="flex:1">Dress up</span>
        </div>
    </div>
    
    <div style="background:#f8f9fa;border:2px solid #000;border-radius:10px;padding:20px;margin-bottom:20px">
        <h3 style="margin-bottom:15px">ğŸ’¼ Work Routine</h3>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-lunch" style="width:25px;height:25px">
            <span style="flex:1">Prepare lunch / Plan takeaway</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-work" style="width:25px;height:25px">
            <span style="flex:1">Get to work</span>
        </div>
    </div>
    
    <div style="background:#f8f9fa;border:2px solid #000;border-radius:10px;padding:20px;margin-bottom:20px">
        <h3 style="margin-bottom:15px">ğŸŒ™ Evening Routine</h3>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-backwork" style="width:25px;height:25px">
            <span style="flex:1">Back from work</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-eat" style="width:25px;height:25px">
            <span style="flex:1">Eat dinner</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-stretch10" style="width:25px;height:25px">
            <span style="flex:1">Stretch 10 min</span>
        </div>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:10px;padding:10px;background:white;border-radius:8px">
            <input type="checkbox" class="routine-check" data-key="r-mom" style="width:25px;height:25px">
            <span style="flex:1">Check on mom</span>
        </div>
    </div>
    
    <div style="text-align:center;padding:20px;background:#e8f5e9;border-radius:10px">
        <h3 id="routineProgress" style="font-size:1.5em;color:#00b894">0/11 Complete</h3>
        <p style="margin-top:10px;color:#666">Keep going, akhi! ğŸ’ª</p>
    </div>
</div>`;
            
            // Study Page
            content.innerHTML += `
<div id="study" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('study')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ§  Study Tracker</h2>
    <input type="date" class="auto-save" data-key="study-date">
    <input type="text" class="auto-save" data-key="study-subj" placeholder="Subject">
    <input type="text" class="auto-save" data-key="study-topic" placeholder="Topic">
    <h3>Key Points</h3>
    <textarea rows="5" class="auto-save" data-key="study-points"></textarea>
    <h3>Questions</h3>
    <textarea rows="3" class="auto-save" data-key="study-q"></textarea>
    <label>Revision Date:</label>
    <input type="date" class="auto-save" data-key="study-rev">
</div>`;
            
            // Budget Page
            content.innerHTML += `
<div id="budget" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('budget')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ’° Budget</h2>
    <input type="text" class="auto-save" data-key="budget-period" placeholder="Period...">
    <h3>ğŸ’µ Income</h3>
    <table class="budget-table">
        <tr><th>Source</th><th>Amount</th></tr>
        <tr><td><input type="text" class="auto-save" data-key="inc1n"></td><td><input type="number" class="auto-save budget-calc" data-key="inc1a" step="0.01"></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="inc2n"></td><td><input type="number" class="auto-save budget-calc" data-key="inc2a" step="0.01"></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="inc3n"></td><td><input type="number" class="auto-save budget-calc" data-key="inc3a" step="0.01"></td></tr>
        <tr style="background:#f8f9fa"><td><strong>TOTAL</strong></td><td><span class="auto-calc" id="totInc">0.00</span></td></tr>
    </table>
    <h3 style="margin-top:20px">ğŸ’³ Expenses</h3>
    <table class="budget-table">
        <tr><th>Category</th><th>Amount</th></tr>
        <tr><td><input type="text" class="auto-save" data-key="exp1n"></td><td><input type="number" class="auto-save budget-calc" data-key="exp1a" step="0.01"></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="exp2n"></td><td><input type="number" class="auto-save budget-calc" data-key="exp2a" step="0.01"></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="exp3n"></td><td><input type="number" class="auto-save budget-calc" data-key="exp3a" step="0.01"></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="exp4n"></td><td><input type="number" class="auto-save budget-calc" data-key="exp4a" step="0.01"></td></tr>
        <tr style="background:#f8f9fa"><td><strong>TOTAL</strong></td><td><span class="auto-calc" id="totExp">0.00</span></td></tr>
    </table>
    <h3 style="margin-top:20px">ğŸ’° Balance</h3>
    <table class="budget-table">
        <tr style="background:#f8f9fa"><td><strong>REMAINING</strong></td><td><span class="auto-calc" id="balance">0.00</span></td></tr>
    </table>
    <h3 style="margin-top:20px">ğŸ¯ Savings</h3>
    <table class="budget-table">
        <tr><th>Goal</th><th>Target</th><th>Saved</th><th>%</th></tr>
        <tr><td><input type="text" class="auto-save" data-key="g1n"></td><td><input type="number" class="auto-save sav-calc" data-key="g1t" step="0.01"></td><td><input type="number" class="auto-save sav-calc" data-key="g1s" step="0.01"></td><td><span class="savings-progress" id="g1p">0%</span></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="g2n"></td><td><input type="number" class="auto-save sav-calc" data-key="g2t" step="0.01"></td><td><input type="number" class="auto-save sav-calc" data-key="g2s" step="0.01"></td><td><span class="savings-progress" id="g2p">0%</span></td></tr>
        <tr><td><input type="text" class="auto-save" data-key="g3n"></td><td><input type="number" class="auto-save sav-calc" data-key="g3t" step="0.01"></td><td><input type="number" class="auto-save sav-calc" data-key="g3s" step="0.01"></td><td><span class="savings-progress" id="g3p">0%</span></td></tr>
    </table>
</div>`;
            
            // Quran Page
            content.innerHTML += `
<div id="quran" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('quran')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ“– Qur'an Reflection</h2>
    <input type="date" class="auto-save" data-key="quran-date">
    <input type="text" class="auto-save" data-key="quran-surah" placeholder="Surah">
    <input type="text" class="auto-save" data-key="quran-ayah" placeholder="Ayah(s)">
    <h3>ğŸ“ Meaning</h3>
    <textarea rows="4" class="auto-save" data-key="quran-mean"></textarea>
    <h3>ğŸ’­ Reflection</h3>
    <textarea rows="4" class="auto-save" data-key="quran-ref"></textarea>
    <h3>ğŸ¯ Action</h3>
    <textarea rows="3" class="auto-save" data-key="quran-act"></textarea>
    <h3>ğŸ¤² Du'a</h3>
    <textarea rows="3" class="auto-save" data-key="quran-dua"></textarea>
</div>`;
            
            // Life Page
            content.innerHTML += `
<div id="life" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('life')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸ¡ Life Organizer</h2>
    <input type="text" class="auto-save" data-key="life-week" placeholder="Week of...">
    <h3>ğŸ§¹ Cleaning</h3>
    <textarea rows="5" class="auto-save" data-key="life-clean"></textarea>
    <h3>ğŸ½ï¸ Meals</h3>
    <textarea rows="8" class="auto-save" data-key="life-meals" placeholder="Breakfast/Lunch/Dinner for week..."></textarea>
    <h3>ğŸš— Errands</h3>
    <textarea rows="4" class="auto-save" data-key="life-err"></textarea>
</div>`;
            
            // Growth Page
            content.innerHTML += `
<div id="growth" class="page">
    <div class="btn-group">
        <button class="btn btn-large" onclick="window.print()">ğŸ–¨ï¸ Print</button>
        <button class="btn btn-large btn-danger" onclick="showResetModal('growth')">ğŸ”„ Reset</button>
    </div>
    <h2>ğŸŒ± Personal Growth</h2>
    <input type="text" class="auto-save" data-key="growth-month" placeholder="Month...">
    <h3>ğŸ¯ Goals</h3>
    <textarea rows="5" class="auto-save" data-key="growth-goals"></textarea>
    <h3>ğŸ’¬ Quote</h3>
    <textarea rows="2" class="auto-save" data-key="growth-quote"></textarea>
    <h3>ğŸ“š Learned</h3>
    <textarea rows="4" class="auto-save" data-key="growth-learn"></textarea>
    <h3>ğŸŒŸ Wins</h3>
    <textarea rows="3" class="auto-save" data-key="growth-wins"></textarea>
    <h3>ğŸ”„ Improve</h3>
    <textarea rows="3" class="auto-save" data-key="growth-improve"></textarea>
</div>`;
            
            // Calendar days
            const calDays = document.getElementById('calDays');
            for (let i = 0; i < 35; i++) {
                calDays.innerHTML += `<div class="day-cell"><input type="text" class="auto-save" data-key="cal${i}"></div>`;
            }
            
            // Water tracker
            const water = document.getElementById('waterTracker');
            for (let i = 0; i < 8; i++) {
                const glass = document.createElement('div');
                glass.className = 'water-glass';
                glass.onclick = function() {
                    this.classList.toggle('filled');
                    saveData(`water${i}`, this.classList.contains('filled')); // Saves as boolean string 'true'/'false'
                };
                // Load data for water glasses
                if (loadData(`water${i}`) === 'true') glass.classList.add('filled');
                water.appendChild(glass);
            }
            
            // Setup daily routine
            setupDailyRoutine();
            
            // Load saved data for text inputs
            document.querySelectorAll('.auto-save').forEach(el => {
                const val = loadData(el.dataset.key);
                if (val) el.value = val;
            });
            
            // Load saved data for checkboxes (FIXED: The loading logic was only half the problem, the saving logic was also incorrect)
            document.querySelectorAll('.auto-save-check').forEach(el => {
                // Checkboxes save "true" or "false" string, so compare against the string 'true'
                if (loadData(el.dataset.key) === 'true') el.checked = true;
            });
            
            // Auto-save event listeners
            document.addEventListener('input', (e) => {
                if (e.target.classList.contains('auto-save')) {
                    saveData(e.target.dataset.key, e.target.value);
                    if (e.target.classList.contains('budget-calc')) calcBudget();
                    if (e.target.classList.contains('sav-calc')) calcSavings();
                }
            });
            
            // FIX: The change event now correctly saves the state of auto-save-check checkboxes
            document.addEventListener('change', (e) => {
                if (e.target.classList.contains('auto-save-check')) {
                    // Checkboxes should save a string representation of their boolean state ('true' or 'false')
                    saveData(e.target.dataset.key, e.target.checked.toString());
                }
                if (e.target.classList.contains('routine-check')) {
                    // Routine checks were already using the correct logic in saveDailyRoutine
                    saveDailyRoutine(e.target.dataset.key, e.target.checked.toString()); 
                    updateRoutineProgress();
                }
            });
            
            calcBudget();
            calcSavings();
            
            // Ensure first tab is active on load
            showPage('daily', { target: document.querySelector('#tabs .tab') });
        }
        
        function setupDailyRoutine() {
            const today = new Date().toDateString();
            const lastDate = loadData('routine-last-date');
            
            // Show today's date
            const dateEl = document.getElementById('routineDate');
            if (dateEl) dateEl.textContent = today;
            
            const routineCheckboxes = document.querySelectorAll('.routine-check');
            const routineKeys = Array.from(routineCheckboxes).map(cb => cb.dataset.key);

            // If it's a new day, reset the routine
            if (lastDate !== today) {
                routineKeys.forEach(key => saveData(key, 'false'));
                saveData('routine-last-date', today);
                
                // Uncheck all routine checkboxes
                routineCheckboxes.forEach(cb => cb.checked = false);
            } else {
                // Load today's routine state (FIXED: Loading was incorrect inside the else block)
                routineCheckboxes.forEach(el => {
                    if (loadData(el.dataset.key) === 'true') el.checked = true;
                });
            }
            
            updateRoutineProgress();
        }
        
        function saveDailyRoutine(key, value) {
            saveData(key, value);
        }
        
        function updateRoutineProgress() {
            // Note: If you add/remove items, update the hardcoded '11' below
            const routineKeys = ['r-shower', 'r-brush', 'r-bed', 'r-stretch5', 'r-dress', 'r-lunch', 'r-work', 'r-backwork', 'r-eat', 'r-stretch10', 'r-mom'];
            let completed = 0;
            routineKeys.forEach(key => {
                if (loadData(key) === 'true') completed++;
            });
            const progressEl = document.getElementById('routineProgress');
            if (progressEl) {
                progressEl.textContent = `${completed}/11 Complete`;
                progressEl.style.color = '#00b894';
                if (completed === 11) {
                    progressEl.innerHTML = 'ğŸ‰ ALL DONE! AMAZING WORK! ğŸ‰';
                }
            }
        }
        
        function loadWeek(w) {
            // Not needed anymore - removed habit tracker
        }
        
        function updateProgress() {
            // Not needed anymore - removed habit tracker
        }
        
        function calcBudget() {
            let inc = 0, exp = 0;
            for (let i = 1; i <= 3; i++) inc += parseFloat(loadData(`inc${i}a`)) || 0;
            for (let i = 1; i <= 4; i++) exp += parseFloat(loadData(`exp${i}a`)) || 0;
            const bal = inc - exp;
            
            const incEl = document.getElementById('totInc');
            const expEl = document.getElementById('totExp');
            const balEl = document.getElementById('balance');
            
            if (incEl) incEl.textContent = inc.toFixed(2);
            if (expEl) expEl.textContent = exp.toFixed(2);
            if (balEl) {
                balEl.textContent = bal.toFixed(2);
                balEl.style.color = bal >= 0 ? '#00b894' : '#d63031';
            }
        }
        
        function calcSavings() {
            for (let i = 1; i <= 3; i++) {
                const target = parseFloat(loadData(`g${i}t`)) || 0;
                const saved = parseFloat(loadData(`g${i}s`)) || 0;
                const pct = target > 0 ? Math.min(100, (saved / target * 100)) : 0;
                const el = document.getElementById(`g${i}p`);
                if (el) el.textContent = pct.toFixed(0) + '%';
            }
        }
        
        initApp();
    </script>
</body>
</html>
